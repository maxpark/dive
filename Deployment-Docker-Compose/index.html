
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for DIVE">
      
      
        <meta name="author" content="Kitware">
      
      
        <link rel="canonical" href="https://kitware.github.io/dive/Deployment-Docker-Compose/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>Running with Docker Compose - DIVE</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#running-with-docker-compose" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DIVE" class="md-header__button md-logo" aria-label="DIVE" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M327.1 96c-89.97 0-168.54 54.77-212.27 101.63L27.5 131.58c-12.13-9.18-30.24.6-27.14 14.66L24.54 256 .35 365.77c-3.1 14.06 15.01 23.83 27.14 14.66l87.33-66.05C158.55 361.23 237.13 416 327.1 416 464.56 416 576 288 576 256S464.56 96 327.1 96zm87.43 184c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24 13.26 0 24 10.74 24 24 0 13.25-10.75 24-24 24z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DIVE
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Running with Docker Compose
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Kitware/dive/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DIVE" class="md-nav__button md-logo" aria-label="DIVE" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M327.1 96c-89.97 0-168.54 54.77-212.27 101.63L27.5 131.58c-12.13-9.18-30.24.6-27.14 14.66L24.54 256 .35 365.77c-3.1 14.06 15.01 23.83 27.14 14.66l87.33-66.05C158.55 361.23 237.13 416 327.1 416 464.56 416 576 288 576 256S464.56 96 327.1 96zm87.43 184c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24 13.26 0 24 10.74 24 24 0 13.25-10.75 24-24 24z"/></svg>

    </a>
    DIVE
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Kitware/dive/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Screenshots/" class="md-nav__link">
        Screenshots
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Web-Version/" class="md-nav__link">
        Web Version
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Dive-Desktop/" class="md-nav__link">
        Desktop Version
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Annotation-QuickStart/" class="md-nav__link">
        Annotation Quickstart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Mouse-Keyboard-Shortcuts/" class="md-nav__link">
        Mouse and Keyboard Shortcuts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Pipeline-Documentation/" class="md-nav__link">
        Pipelines & Training
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Annotation Interface Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Annotation Interface Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Annotation Interface Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Annotation-User-Interface-Overview/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Navigation-Bar/" class="md-nav__link">
        Navigation Bar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Edit-Bar/" class="md-nav__link">
        Edit Bar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Annotation-View/" class="md-nav__link">
        Annotation View
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Type-List/" class="md-nav__link">
        Type List
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Track-List/" class="md-nav__link">
        Track List
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Interpolation/" class="md-nav__link">
        Interpolation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Attributes/" class="md-nav__link">
        Attributes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Deployment Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deployment Documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Deployment Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Deployment-Overview/" class="md-nav__link">
        Deployment Options Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Deployment-Provision/" class="md-nav__link">
        Provisioning Google Cloud
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Running with Docker Compose
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Running with Docker Compose
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#container-images" class="md-nav__link">
    Container Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-dependencies" class="md-nav__link">
    Install dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-deployment" class="md-nav__link">
    Basic deployment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-deployment" class="md-nav__link">
    Production deployment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addon-management" class="md-nav__link">
    Addon management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-reference" class="md-nav__link">
    Configuration Reference
  </a>
  
    <nav class="md-nav" aria-label="Configuration Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#web-server-config" class="md-nav__link">
    Web Server config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#worker-config" class="md-nav__link">
    Worker config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-gpu-job-runner-in-standalone-mode" class="md-nav__link">
    Running the GPU Job Runner in standalone mode
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Deployment-Storage/" class="md-nav__link">
        Cloud Storage Integration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Advanced features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced features" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Advanced features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Pipeline-Upload/" class="md-nav__link">
        Custom Pipeline Upload
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Command-Line-Tools/" class="md-nav__link">
        Command Line Tools
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../DataFormats/" class="md-nav__link">
        Data Formats
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../FAQ/" class="md-nav__link">
        Frequently Asked Questions
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#container-images" class="md-nav__link">
    Container Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-dependencies" class="md-nav__link">
    Install dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-deployment" class="md-nav__link">
    Basic deployment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-deployment" class="md-nav__link">
    Production deployment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addon-management" class="md-nav__link">
    Addon management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-reference" class="md-nav__link">
    Configuration Reference
  </a>
  
    <nav class="md-nav" aria-label="Configuration Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#web-server-config" class="md-nav__link">
    Web Server config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#worker-config" class="md-nav__link">
    Worker config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-gpu-job-runner-in-standalone-mode" class="md-nav__link">
    Running the GPU Job Runner in standalone mode
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/Kitware/dive/edit/master/docs/Deployment-Docker-Compose.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="running-with-docker-compose">Running with Docker Compose</h1>
<p>Start here once you have SSH access and <code>sudo</code> privileges for a server or VM. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Docker server installation is only supported on Linux distributions</p>
</div>
<h2 id="container-images">Container Images</h2>
<p>A DIVE Web deployment consists of 2 main services.</p>
<ul>
<li><a href="https://hub.docker.com/r/kitware/viame-web">kitware/viame-web</a> - the web server</li>
<li><a href="https://hub.docker.com/r/kitware/viame-worker">kitware/viame-worker</a> - the queue worker</li>
</ul>
<p>In addition, a database (MongoDB) and a queue service (RabbitMQ) are required.</p>
<p><img alt="DIVE-Web-Architecture-Diagram.svg" src="../images/Diagrams/DIVE-Web-Architecture-Diagram.svg" /></p>
<h2 id="install-dependencies">Install dependencies</h2>
<p>SSH into the target server and install these system dependencies.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can skip this section if you used Ansible to configure your server, as it already installed all necessary dependencies.</p>
</div>
<ul>
<li>Install NVIDIA driver version <strong>&gt;= 450.80.02</strong> and <strong>CUDA 11.0+</strong> <code>sudo ubuntu-drivers install</code></li>
<li>Install <code>docker</code> version <strong>19.03+</strong> <a href="https://docs.docker.com/engine/install/ubuntu/">guide</a></li>
<li>Install <code>docker-compose</code> version <strong>1.28.0+</strong> <a href="https://docs.docker.com/compose/install/">guide</a></li>
<li>Install <a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#docker">nvidia-container-toolkit</a></li>
</ul>
<h2 id="basic-deployment">Basic deployment</h2>
<p>Clone this repository and configure options in <code>.env</code> .</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1"># Clone this repository</span>
git clone https://github.com/Kitware/dive /opt/dive

<span class="c1"># Change to correct directory</span>
<span class="nb">cd</span> /opt/dive

<span class="c1"># Initiate the .env file</span>
cp .env.default .env

<span class="c1"># Edit the .env file</span>
<span class="c1"># See configuration options below and inline comments</span>
nano .env

<span class="c1"># Pull pre-built images</span>
docker-compose pull

<span class="c1"># Bring the services up</span>
<span class="c1"># Make sure to specify docker-compose.yml unless you intend to mount code for development</span>
docker-compose -f docker-compose.yml up -d
</code></pre></div>
</td></tr></table>
<p>VIAME server will be running at <a href="http://localhost:8010/">http://localhost:8010</a>. You should see a page that looks like this. The default username and password is <code>admin:letmein</code>.</p>
<p><img alt="Login Page" src="../images/General/login.png" /></p>
<h2 id="production-deployment">Production deployment</h2>
<p>If you have a server with a <strong>public-facing IP address</strong> and a <strong>domain name</strong> that points to it, you should be able to use our production deployment configuration.  This is the way we deploy viame.kitware.com.</p>
<ul>
<li><code>containrrr/watchtower</code> updates the running containers on a schedule using automated image builds from docker hub (above).</li>
<li><code>linuxserver/duplicati</code> is included to schedule nightly backups, but must be manually configured.</li>
</ul>
<p>You should scale the girder web server up to an appropriate number.  This stack will automatically load-balance across however many instances you bring up.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1"># Continuing from above, modify .env again to include the production variables</span>
nano .env

<span class="c1"># pull extra containers</span>
docker-compose -f docker-compose.yml -f docker-compose.prod.yml pull

<span class="c1"># scale the web service up</span>
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d --scale <span class="nv">girder</span><span class="o">=</span><span class="m">4</span>
</code></pre></div>
</td></tr></table>
<h2 id="addon-management">Addon management</h2>
<p>After initial deployment, a DIVE server will only have basic VIAME pipelines available. VIAME optional patches are installed and upgraded using a celery task that must be triggered by hand. Run this by issuing a <u><code>POST /dive_configuration/upgrade_pipelines</code></u> request from the swagger UI at <code>http://{domain}/api/v1</code> .</p>
<ul>
<li>Whether you <code>force</code> or not, only those pipelines from addons from the exact urls passed will be enabled on the server.</li>
<li>An old addon can be disabled by simply omitting its download from the upgrade payload.</li>
<li><code>force</code> should be used to force re-download of all URLs in the payload even if their zipfiles have been cached.</li>
<li>An upgrade run is always required if the "common" pipelines in the base image change.  These are updated for every run, and do not require <code>force</code>.</li>
<li>See the job log to verify the exact actions taken by an upgrade job.</li>
</ul>
<p><img alt="Upgrade Pipelines Swagger" src="../images/UpgradePipelinesSwagger.png" /></p>
<h2 id="configuration-reference">Configuration Reference</h2>
<h3 id="web-server-config">Web Server config</h3>
<p>This image contains both the backend and client.</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>GIRDER_MONGO_URI</td>
<td><code>mongodb://mongo:27017/girder</code></td>
<td>a mongodb connection string</td>
</tr>
<tr>
<td>GIRDER_ADMIN_USER</td>
<td><code>admin</code></td>
<td>admin username</td>
</tr>
<tr>
<td>GIRDER_ADMIN_PASS</td>
<td><code>letmein</code></td>
<td>admin password</td>
</tr>
<tr>
<td>CELERY_BROKER_URL</td>
<td><code>amqp://guest:guest@default/</code></td>
<td>rabbitmq connection string</td>
</tr>
<tr>
<td>WORKER_API_URL</td>
<td><code>http://girder:8080/api/v1</code></td>
<td>Address for workers to reach web server</td>
</tr>
</tbody>
</table>
<p>There is additional configuration for the RabbitMQ Management plugin. It only matters if you intend to allow individual users to configure private job runners in standalone mode, and can otherwise be ignored.</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>RABBITMQ_MANAGEMENT_USERNAME</td>
<td><code>guest</code></td>
<td>Management API username</td>
</tr>
<tr>
<td>RABBITMQ_MANAGEMENT_PASSWORD</td>
<td><code>guest</code></td>
<td>Management API password</td>
</tr>
<tr>
<td>RABBITMQ_MANAGEMENT_VHOST</td>
<td><code>default</code></td>
<td>Virtual host should match <code>CELERY_BROKER_URL</code></td>
</tr>
<tr>
<td>RABBITMQ_MANAGEMENT_URL</td>
<td><code>http://rabbit:15672/</code></td>
<td>Management API Url</td>
</tr>
</tbody>
</table>
<p>You can also pass <a href="https://girder.readthedocs.io/en/latest/">girder configuration</a> and <a href="https://docs.celeryproject.org/en/stable/userguide/configuration.html#std-setting-broker_connection_timeout">celery configuration</a>.</p>
<h3 id="worker-config">Worker config</h3>
<p>This image contains a celery worker to run VIAME pipelines and transcoding jobs.</p>
<blockquote>
<p><strong>Note</strong>: Either a broker url or DIVE credentials must be supplied.</p>
</blockquote>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>WORKER_WATCHING_QUEUES</td>
<td>null</td>
<td>one of <code>celery</code>, <code>pipelines</code>, <code>training</code>.  Ignored in standalone mode.</td>
</tr>
<tr>
<td>WORKER_CONCURRENCY</td>
<td><code># of CPU cores</code></td>
<td>max concurrnet jobs. <strong>Lower this if you run training</strong></td>
</tr>
<tr>
<td>WORKER_GPU_UUID</td>
<td>null</td>
<td>leave empty to use all GPUs.  Specify UUID to use specific device</td>
</tr>
<tr>
<td>CELERY_BROKER_URL</td>
<td><code>amqp://guest:guest@default/</code></td>
<td>rabbitmq connection string. Ignored in standalone mode.</td>
</tr>
<tr>
<td>KWIVER_DEFAULT_LOG_LEVEL</td>
<td><code>warn</code></td>
<td>kwiver log level</td>
</tr>
<tr>
<td>DIVE_USERNAME</td>
<td>null</td>
<td>Username to start private queue processor. Providing this enables standalone mode.</td>
</tr>
<tr>
<td>DIVE_PASSWORD</td>
<td>null</td>
<td>Password for private queue processor. Providing this enables standalone mode.</td>
</tr>
<tr>
<td>DIVE_API_URL</td>
<td><code>https://viame.kitware.com/api/v1</code></td>
<td>Remote URL to authenticate against</td>
</tr>
</tbody>
</table>
<p>You can also pass <a href="https://docs.celeryproject.org/en/stable/userguide/configuration.html#std-setting-broker_connection_timeout">regular celery configuration variables</a>.</p>
<h2 id="running-the-gpu-job-runner-in-standalone-mode">Running the GPU Job Runner in standalone mode</h2>
<p><strong>Linux Only.</strong></p>
<p>Individual users can run a standalone worker to process private jobs from VIAME Web.</p>
<ul>
<li>Install VIAME from <a href="https://github.com/VIAME/VIAME">the github page</a> to <code>/opt/noaa/viame</code>.</li>
<li>Activate the install with <code>source setup_viame.sh</code>.</li>
<li>Install VIAME pipeline addons by running <code>cd bin &amp;&amp; download_viame_addons.sh</code> from the VIAME install directory.</li>
<li>Enable the private user queue for your jobs by visiting <a href="https://viame.kitware.com/#/jobs">the jobs page</a></li>
<li>Run a worker using the docker command below</li>
</ul>
<blockquote>
<p><strong>Note</strong>: The <code>--volume</code> mount maps to the host installation.  You may need to change the source from <code>/opt/noaa/viame</code> depending on your install location, but <strong>you should not</strong> change the destination from <code>/tmp/addons/extracted</code>.</p>
</blockquote>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>docker run --rm --name dive_worker <span class="se">\</span>
  --gpus all <span class="se">\</span>
  --ipc host <span class="se">\</span>
  --volume <span class="s2">&quot;/opt/noaa/viame/:/tmp/addons/extracted:ro&quot;</span> <span class="se">\</span>
  -e <span class="s2">&quot;WORKER_CONCURRENCY=2&quot;</span> <span class="se">\</span>
  -e <span class="s2">&quot;DIVE_USERNAME=CHANGEME&quot;</span> <span class="se">\</span>
  -e <span class="s2">&quot;DIVE_PASSWORD=CHANGEME&quot;</span> <span class="se">\</span>
  -e <span class="s2">&quot;DIVE_API_URL=https://viame.kitware.com/api/v1&quot;</span> <span class="se">\</span>
  kitware/viame-worker:latest
</code></pre></div>
</td></tr></table>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../Deployment-Provision/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Provisioning Google Cloud" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Provisioning Google Cloud
            </div>
          </div>
        </a>
      
      
        
        <a href="../Deployment-Storage/" class="md-footer__link md-footer__link--next" aria-label="Next: Cloud Storage Integration" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Cloud Storage Integration
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>